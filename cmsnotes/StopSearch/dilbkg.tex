\clearpage

\section{Background Estimation Technique}

The SM background in the signal region defined by requirements of large \MET\ and \mt\ is estimated using MC.
The MC is validated using data control samples, which are used to derive data-to-MC scale factors and corresponding uncertainties.
We consider three samples:

\begin{itemize}
\item Dilepton sample (exactly 2 selected leptons): used to correct the \njets\ distribution in \ttll\ MC, which is not necessarily well-modelled since ISR jets 
are needed to satisfy the \njets $\geq$ 4 requirement defining the signal region;
\item Inclusive sample (at least 1 selected lepton): used to define a scale factor which corrects for effects of integrated luminosity, \ttbar\ cross section,
jet energy scale and jet selection efficiencies, lepton selection and trigger efficiencies; 
{\bf THING 1 we are uncertain about: should this sample be fully inclusive and require AT LEAST 1 lepton, or should we veto events with a 2nd lepton and remove only the isolated track veto}.
\item Signal sample (exactly 1 selected lepton): this is the sample used to define the signal region. In addition, this sample is used to determine a scale 
factor accounting for possible data vs. MC discrepancies in the isolated track fake rate for backgrounds which have only 1 genuine lepton.
\end{itemize}

\subsection{Step 1: Use dilepton control sample to correct the \njets\ distributon in \ttll\ MC}

The dilepton control sample is defined by the following requirements:
\begin{itemize}
\item Exactly 2 selected electrons or muons with \pt $>$ 20 GeV
\item \MET\ $>$ 50 GeV
\item $\geq1$ b-tagged jet
\end{itemize}

This sample is dominated by \ttll. The distribution of \njets\ for data and MC passing this selection is displayed in Fig.~\ref{fig:dilepton_njets}. 
We use this distribution to derive scale factors which reweight the \ttll\ MC \njets\ distribution to match the data. We define the following
quantities

\begin{itemize}
\item $N_{2}=$ data yield minus non-dilepton \ttbar\ MC yield for \njets\ $\leq$ 2
\item $N_{3}=$ data yield minus non-dilepton \ttbar\ MC yield for \njets\ = 3
\item $N_{4}=$ data yield minus non-dilepton \ttbar\ MC yield for \njets\ $\geq$ 4
\item $M_{2}=$ dilepton \ttbar\ MC yield for \njets\ $\leq$ 2
\item $M_{3}=$ dilepton \ttbar\ MC yield for \njets\ = 3
\item $M_{4}=$ dilepton \ttbar\ MC yield for \njets\ $\geq$ 4
\end{itemize}

We use these yields to define 3 scale factors, which quantify the data/MC ratio in the 3 \njets\ bins:

\begin{itemize}
\item $SF_2 = N_2 / M_2$
\item $SF_3 = N_3 / M_3$
\item $SF_4 = N_4 / M_4$
\end{itemize}

And finally, we define the scale factors $K_3$ and $K_4$:

\begin{itemize}
\item $K_3 = SF_3 / SF_2$
\item $K_4 = SF_4 / SF_2$
\end{itemize}

The scale factor $K_3$ is extracted from dilepton \ttbar\ events with \njets = 3, which have exactly 1 ISR jet.
The scale factor $K_4$ is extracted from dilepton \ttbar\ events with \njets $\geq$ 4, which have at least 2 ISR jets.
Both of these scale factors are needed since dilepton \ttbar\ events which fall in our signal region (including
the \njets $\geq$ 4 requirement) may require exactly 1 ISR jet, in the case that the second lepton is reconstructed
as a jet, or at least 2 ISR jets, in the case that the second lepton is not reconstructed as a jet. These scale
factors are applied to the dilepton \ttbar\ MC only. For a given MC event, we determine whether to use $K_3$ or $K_4$
by counting the number of reconstructed jets in the event ($N_{\rm{jets}}^R$) , and subtracting off any reconstructed 
jet which is matched to the second lepton at generator level ($N_{\rm{jets}}^\ell$); $N_{\rm{jets}}^{\rm{cor}} = N_{\rm{jets}}^R - N_{\rm{jets}}^\ell$.
For events with $N_{\rm{jets}}^{\rm{cor}}=3$ the factor $K_3$ is applied, while for events with $N_{\rm{jets}}^{\rm{cor}}\geq4$ the factor $K_4$ is applied.
For all subsequent steps, the scale factors $K_3$ and $K_4$ have been applied to the \ttll\ MC.
 
\subsection{Step 2: Use the inclusive sample to define a data-to-MC scale factor}

The inclusive sample is defined by the following requirements

\begin{itemize}
\item At least 1 selected electron (muon) with \pt $>$ 30 GeV and $|\eta|<2.5$ ($|\eta|<2.1$)
\item At least 4 selected jets, with at least 1 b-tagged jet
\item \MET\ $>$ 50 GeV
\end{itemize}

The largest contribution to this sample is \ttlj, but \wjets\ and \ttll\ also have significant contributions.
This sample is defined by the same requirements as the signal sample, with the exception that here we do not
veto events containing an isolated track. We use this sample to define an overall scale factor ($SF$) which is applied
to the full MC cocktail. To do so we define:

\begin{itemize}
\item $N_{\rm{peak}}$ = data yield in the peak region $60<\mt<100$ GeV
\item $M_{\rm{peak}}$ = MC yield in the peak region $60<\mt<100$ GeV
\item $SF_{all} = N_{\rm{peak}} / M_{\rm{peak}}$
\end{itemize}

For all subsequent steps, the scale factor $SF_{all}$ is applied to all MC contributions.

\subsection{Step 3: Use the signal sample to apply a correction factor to the single lepton background}

The signal sample is defined by the same requirements as the inclusive sample, except that we veto events containing
an isolated track. The background is the inclusive sample can be split into 2 contributions:

\begin{itemize}
\item Dilepton background: mostly \ttll.
\item Single lepton background: mostly \ttlj\ and \wjets;
\end{itemize}

The isolated track veto impacts these 2 contributions in different ways. For the dilepton background, the veto
rejects events which have a genuine 2nd lepton, so applying the isolated track veto scales the dilepton background
by the efficiency $\epsilon$ to identify the isolated track. For the single lepton background, the veto rejects events
which do not have a genuine 2nd lepton but which have a ``fake'' isolated track, so the isolated track veto scales
the single lepton background by (1-FR), where FR is the ``fake rate'' to identify an isolated track in events which
contain no genuine 2nd lepton. 

The isolated track efficiency $\epsilon$ can be measured in data and MC using $Z\to\ell\ell$ tag-and-probe studies,
but the measurement of the FR in data is non-trivial. We therefore use the tag-and-probe studies to apply a correction
to the \ttll\ MC, and then scale the single lepton background such that the total MC matches the data in the \mt\ peak region.

In detail, the procedure to correct the dilepton background is:

\begin{itemize}
\item Using tag-and-probe studies, we plot the distribution of {\bf absolute} track isolation for identified probe electrons
and muons {\bf TODO: need to compare the e vs. $\mu$ track iso distributions, they might differ due to e$\to$e$\gamma$}.
\item We verify that the distribution of absolute track isolation does not depend on the \pt\ of the probe lepton.
This is due to the fact that this isolation is from ambient PU and jet activity in the event, which is uncorrelated with
the lepton \pt {\bf TODO: verify this in data and MC}.
\item Our requirement is {\bf relative} track isolation $<$ 0.1. For a given \ttll\ MC event, we determine the \pt of the 2nd
lepton and translate this to find the corresponding requirement on the {\bf absolute} track isolation, which is simply $0.1\times$\pt.
\item We measure the efficiency to satisfy this requirement in data and MC, and define a scale-factor $SF_{\epsilon(trk)}$ which
is the ratio of the data-to-MC efficiencies. This scale-factor is applied to the \ttll\ MC event.
\item {\bf THING 2 we are unsure about: we can measure this SF for electrons and for muons, but we can't measure it for hadronic tracks from $\tau$ decays. Verena has showed that the absolute track isolation distribution in hadronic $\tau$ tracks is harder due to $\pi^0\to\gamma\gamma$ with $\gamma\to e^+e^-$.}
\end{itemize} 

At this point we are done applying scale factors to the dilepton background. We next apply a scale factor to the single lepton
background. We use the following quantities:

\begin{itemize}
\item $N_{\rm{peak}}$ =  data yield in the peak region $60<\mt<100$ GeV
\item $M^{\ell}_{\rm{peak}}$ =  single lepton background MC in the peak region $60<\mt<100$ GeV
\item $M^{\ell\ell}_{\rm{peak}}$ =  dilepton background MC in the peak region $60<\mt<100$ GeV
\item $SF_{\ell} = (N_{\rm{peak}} - M^{\ell\ell}_{\rm{peak}} )/ M^{\ell}_{\rm{peak}}$
\end{itemize}

The scale factor $SR_{\ell}$ is applied to the single lepton background to account for potential data vs. MC discrepancies 
in the isolated track veto.


